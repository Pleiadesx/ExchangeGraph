(this["webpackJsonpcrypto-price"]=this["webpackJsonpcrypto-price"]||[]).push([[0],{155:function(e,t,n){"use strict";n.r(t);var r,a=n(1),c=n.n(a),o=n(39),i=n.n(o),l=(n(94),n(95),n(10)),u=n(86),s=n(40),d=n(84),h=n(31),f=h.c,j=n(17),b=n(14),p=n(9),x=n.n(p),O=n(27),m=n(22),v=n(23),g=n(32),y=n(82),k=n.n(y);!function(e){e[e.TWO_BY_TWO=0]="TWO_BY_TWO"}(r||(r={}));var S={exchangeInfoStore:{},data:{},history:{},displayMode:r.TWO_BY_TWO,dataLimit:100};function I(e){return{oneCoinBuyPrice:e.oneCoinBuyPrice,oneCoinSellPrice:e.oneCoinSellPrice}}var w=function(e,t){return e.exchangeId in t.exchangeInfoStore};var C=Object(v.b)("priceData/connectToRSocket",function(){var e=Object(O.a)(x.a.mark((function e(t){var n,r,a,c,o;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.url,r=t.mimeType,a=void 0===r?"application/json":r,c=new m.RSocketClient({transport:new k.a({url:n,wsCreator:function(e){return new WebSocket(e)}},m.BufferEncoders),setup:{dataMimeType:a,metadataMimeType:"message/x.rsocket.composite-metadata.v0",keepAlive:2e4,lifetime:6e4},errorHandler:function(e){console.log(e)}}),e.next=4,c.connect();case 4:return o=e.sent,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),U=Object(v.b)("priceData/FetchDataFrames",function(){var e=Object(O.a)(x.a.mark((function e(t,n){var r,a,c,o,i,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.endpoint,a=t.perMin,c=void 0===a?1e3:a,o=n.getState,n.rejectWithValue,i=n.dispatch,void 0!==(l=o().priceData.dataSocket)&&Object(g.c)(l,r).subscribe({onSubscribe:function(e){setInterval((function(){return e.request(c)})),e.request(c)},onNext:function(e){var t=Object(g.d)(e.data);i(B(t))},onError:function(e){console.log(e)}});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),B=Object(v.b)("priceData/frameReceived",function(){var e=Object(O.a)(x.a.mark((function e(t,n){var r,a,c,o,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState,a=n.dispatch,c=P.actions,o=r(),w(t,o.priceData)){e.next=10;break}return a(c.createExchangeInfoPlaceholder(t.exchangeId)),e.next=7,Object(g.b)(t.exchangeId);case 7:i=e.sent,a(c.updateExchangeInfo({id:t.exchangeId,info:i})),o.priceData;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),P=Object(v.c)({name:"priceData",initialState:S,reducers:{createExchangeInfoPlaceholder:function(e,t){t.payload in e.exchangeInfoStore&&(e.exchangeInfoStore[t.payload]=Object(g.a)(t.payload))},updateExchangeInfo:function(e,t){e.exchangeInfoStore[t.payload.id]=t.payload.info},updateDataLimit:function(e,t){e.dataLimit=t.payload}},extraReducers:function(e){e.addCase(B.fulfilled,(function(e,t){if(t.payload.exchangeId in e.data){var n=I(t.payload),r=I(t.payload);e.data[t.payload.exchangeId][t.payload.market]=n,t.payload.market in e.history[t.payload.exchangeId]?e.history[t.payload.exchangeId][t.payload.market].push(r):e.history[t.payload.exchangeId][t.payload.market]=[r],e.dataLimit>-1&&e.history[t.payload.exchangeId][t.payload.market].length>e.dataLimit&&e.history[t.payload.exchangeId][t.payload.market].shift()}else{var a=I(t.payload),c=I(t.payload);e.data[t.payload.exchangeId]=Object(b.a)({},t.payload.market,a),e.history[t.payload.exchangeId]=Object(b.a)({},t.payload.market,Array(c))}})),e.addCase(C.fulfilled,(function(e,t){console.log("connected to rsocket fulfilled"),e.dataSocket=t.payload})),e.addCase(U.fulfilled,(function(e,t){}))}}),D=function(e){return e.priceData.dataSocket},N=function(e){return e.priceData.data},L=function(e){return e.priceData.history},T=function(e){return e.priceData.exchangeInfoStore},E=P.reducer,M=n(41),W=(n(68),n(85)),R=n(15),_=n(2),A="#51ff97",q="#ff2424",F="#545D69",H=function(e){return e.charAt(0).toUpperCase()+e.toLowerCase().slice(1)},J=function(e){if(e.length>1){var t=[{title:"Buy Price",color:A},{title:"Sell Price",color:q}],n=e.map((function(e,t){return{x:t,y:e.oneCoinBuyPrice}})),r=e.map((function(e,t){return{x:t,y:e.oneCoinSellPrice}}));return Object(_.jsx)("div",{children:Object(_.jsxs)(s.a,{children:[Object(_.jsx)(d.a,{xs:10,children:Object(_.jsxs)(R.f,{margin:{left:100},width:700,height:500,children:[Object(_.jsx)(R.b,{}),Object(_.jsx)(R.d,{}),Object(_.jsx)(R.e,{}),Object(_.jsx)(R.g,{}),Object(_.jsx)(R.c,{curve:"curveMonotoneX",data:n,color:A}),Object(_.jsx)(R.c,{curve:"curveMonotoneX",data:r,color:q})]})}),Object(_.jsx)(d.a,{children:Object(_.jsx)(R.a,{items:t})})]})})}},Y=function(e,t,n){return void 0===t?void 0===n||0===n.length?H(e):Object(_.jsx)("div",{children:Object(_.jsx)("a",{href:n,children:H(e)})}):Object(_.jsxs)("div",{children:[Object(_.jsx)(W.a,{style:{width:30,height:"auto"},src:t,roundedCircle:!0})," "," ",Object(_.jsx)("a",{href:n,className:"market-cell-name",children:H(e)})]})};function G(e){var t=e.marketId,n=e.price,r=e.history,a=e.highlighted,c=void 0===a?{buy:!1,sell:!1}:a,o=e.logoUrl,i=e.marketUrl;return Object(_.jsx)("div",{children:Object(_.jsxs)(M.a,{className:"market-card",text:"white",children:[Object(_.jsx)(M.a.Header,{children:Y(t,o,i)}),Object(_.jsxs)(M.a.Body,{children:[Object(_.jsxs)(s.a,{children:[Object(_.jsx)(d.a,{children:Object(_.jsxs)("div",{className:"chart-buy-price",style:(null===c||void 0===c?void 0:c.buy)?{color:A,background:F}:{color:A},children:["Buy: ",j.b.format(n.oneCoinBuyPrice)]})}),Object(_.jsx)(d.a,{children:Object(_.jsxs)("div",{className:"chart-sell-price",style:(null===c||void 0===c?void 0:c.sell)?{color:q,background:F}:{color:q},children:["Sell: ",j.b.format(n.oneCoinSellPrice)]})})]}),J(r)]})]})})}var K=function(e){return null!=e?Object(_.jsxs)("div",{children:[Object(_.jsx)(W.a,{style:{width:30,height:"auto"},src:e.exchangeLogoUrl,roundedCircle:!0})," ",Object(_.jsx)("a",{href:null===e||void 0===e?void 0:e.exchangeUrl,className:"exchange-cell-name",children:null===e||void 0===e?void 0:e.exchangeName})]}):" "};function X(e){var t=e.exchangeInfo,n=e.marketRecord,r=e.historyRecord,a=e.minBuy,c=e.maxSell,o=function(e,t){return{buy:!!a[e]&&a[e]===t.oneCoinBuyPrice,sell:!!c[e]&&c[e]===t.oneCoinSellPrice}};return Object(_.jsx)("div",{children:Object(_.jsxs)(M.a,{className:"exchange-card",text:"white",children:[Object(_.jsx)(M.a.Header,{children:K(t)}),Object(_.jsx)(M.a.Body,{children:Object.entries(n).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var n,a,c=Object(l.a)(e,2),i=c[0],u=c[1];return Object(_.jsx)(s.a,{style:{padding:10},children:Object(_.jsx)(G,{highlighted:o(i,u),marketId:i,price:u,history:r[i],logoUrl:null===t||void 0===t||null===(n=t.marketLogoUrls)||void 0===n?void 0:n[i],marketUrl:null===t||void 0===t||null===(a=t.marketUrls)||void 0===a?void 0:a[i]})},i)}))})]})})}var z=n(3);function V(e,t,n){return Object.entries(e).reduce((function(e,r){var a=Object(l.a)(r,2),c=(a[0],a[1]),o=Object.entries(c).reduce((function(e,r){var a=Object(l.a)(r,2),c=a[0],o=a[1];return c in e?Object(z.a)(Object(z.a)({},e),{},Object(b.a)({},c,t(n(o),e[c]))):Object(z.a)(Object(z.a)({},e),{},Object(b.a)({},c,n(o)))}),{});return Object.entries(o).filter((function(n){var r=Object(l.a)(n,2),a=r[0],c=r[1];return!(a in e)||t(c,e[a])===c})).reduce((function(e,t){var n=Object(l.a)(t,2),r=n[0],a=n[1];return Object(z.a)(Object(z.a)({},e),{},Object(b.a)({},r,a))}),e)}),{})}var $=function(){var e=f(D),t=f(N),n=f(L),r=f(T),c=Object(h.b)();Object(a.useEffect)((function(){void 0===e&&c(C({url:j.d}))})),Object(a.useEffect)((function(){void 0!==e?(console.log("rsocket was valid"),c(U({endpoint:j.c}))):console.log("rsocket was not valid")}),[e]);var o=V(t,(function(e,t){return Math.min(e,t)}),(function(e){return e.oneCoinBuyPrice})),i=V(t,(function(e,t){return Math.max(e,t)}),(function(e){return e.oneCoinSellPrice}));return Object(_.jsx)("div",{children:Object(_.jsx)(u.a,{fluid:!0,children:Object(_.jsx)(s.a,{children:Object.entries(t).map((function(e){var t=Object(l.a)(e,2),a=t[0],c=t[1];return Object(_.jsx)(d.a,{children:Object(_.jsx)(X,{maxSell:i,minBuy:o,exchangeInfo:a in r?r[a]:null,marketRecord:c,historyRecord:n[a]},a)})}))})})})};n(154);var Q=function(){return Object(_.jsx)("div",{className:"App",children:Object(_.jsx)($,{})})},Z=Object(v.a)({reducer:{priceData:E},middleware:function(e){return e({serializableCheck:!1})}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(h.a,{store:Z,children:Object(_.jsx)(Q,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},17:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r="api.prices.one_coin_stream",a="/rsocket",c="/exchangeInfo/",o=new Intl.NumberFormat("en-us",{style:"currency",currency:"USD"})},32:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(9),a=n.n(r),c=n(27),o=n(22),i=n(17);function l(e){return{exchangeLogoUrl:"",exchangeName:e,exchangeUrl:"",marketUrls:{},marketLogoUrls:{}}}var u=function(t,n){return t.requestStream({metadata:Object(o.encodeAndAddWellKnownMetadata)(e.alloc(0),o.MESSAGE_RSOCKET_ROUTING,e.from(String.fromCharCode(n.length)+n))})},s=function(e){var t=JSON.parse(e);return{market:t.coinType,exchangeId:t.exchangeId,oneCoinBuyPrice:t.bestBuyPrice.price,oneCoinSellPrice:t.bestSellPrice.price}};function d(e){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(i.a+t);case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,e.abrupt("return",{exchangeName:r.exchangeName,exchangeLogoUrl:r.exchangeLogoUrl,exchangeUrl:r.exchangeUrl,marketUrls:r.marketUrls,marketLogoUrls:r.marketLogoUrls});case 10:return e.prev=10,e.t0=e.catch(0),console.log("error: "),console.log(e.t0),e.abrupt("return",l(t));case 15:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}}).call(this,n(44).Buffer)},94:function(e,t,n){},95:function(e,t,n){}},[[155,1,2]]]);
//# sourceMappingURL=main.c3e87584.chunk.js.map